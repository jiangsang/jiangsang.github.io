---
layout: post
title: laydateä½¿ç”¨é—®é¢˜æ€»ç»“
categories:
 - Layui
tags:
 - laydate
---

åœ¨ä½¿ç”¨laydateçš„æ—¶å€™ï¼Œé‡åˆ°ä¸€äº›é—®é¢˜å’Œæ¡†æ¶çš„bugï¼Œåœ¨è¿™é‡Œåšä¸ªè®°å½•å’Œæé«˜è§£å†³æ–¹æ³•ï¼ˆå¦‚æœæœ‰çš„è¯ğŸ˜„ï¼‰ï¼Œç”±äºè‡ªå·±ä¸æ˜¯ä¸“ä¸šå‰ç«¯ï¼Œå¯èƒ½æå‡ºçš„æ–¹æ³•ä¹Ÿä¸æ˜¯å¾ˆå¥½ï¼Œä½†æœ‰æ€»æ¯”æ²¡æœ‰å¥½ã€‚
### æˆ‘çš„ç¯å¢ƒ
- ç³»ç»Ÿï¼šmacOS Catalina10.15.6
- æµè§ˆå™¨ï¼šChrome 87.0.4280.88
- Layuiç‰ˆæœ¬ï¼š2.3.0

  <!-- more -->

### ä½¿ç”¨æ—¶é‡åˆ°çš„é—®é¢˜  

#### æ—¥æœŸé€‰æ‹©æ¡†ä¸å¼¹å‡º

æ—¥æœŸæ§ä»¶ç»‘å®šåœ¨è¾“å…¥æ¡†å…ƒç´ æ—¶,é»˜è®¤çš„è§¦å‘äº‹ä»¶ä¸ºï¼šfocus,ä¼šæœ‰ä¸€äº›è§¦å‘BUG,æ¸²æŸ“æ—¶æ”¹ä¸º`trigger:'click'`å³å¯.

å¦‚æœç»‘å®šçš„å…ƒç´ éè¾“å…¥æ¡†ï¼Œåˆ™é»˜è®¤äº‹ä»¶ä¸ºï¼šclick

#### type=â€œmonthâ€æ—¶çš„é—®é¢˜  
type=â€œmonthâ€å·²ç»ç¢°åˆ°å‡ ä¸ªé—®é¢˜äº†ï¼Œä¸»è¦æ˜¯æœ‰çš„åœ°æ–¹è·Ÿé»˜è®¤type=â€œdateâ€çš„é€»è¾‘ä¸ä¸€æ ·ã€‚
##### å¼€å¯èŒƒå›´é€‰æ‹©æ—¶changeäº‹ä»¶æ— æ•ˆ  
```javascript
laydate.render({
  elem: '#test1' ,//æŒ‡å®šå…ƒç´ 
  type:'month',
  range:'ï½',
  change:function(value,date,endDate){
    console.log(value)
  }
});
```
ç»æµ‹è¯•ï¼ŒæŠŠ`type:'month'`æ³¨é‡Šæ—¶ï¼Œchangeäº‹ä»¶ç”Ÿæ•ˆï¼ŒæŠŠ`range:'ï½'`æ³¨é‡Šæ—¶changeäº‹ä»¶ç”Ÿæ•ˆã€‚  
å¥‡æ€ªçš„æ˜¯ï¼Œå½“ä¸¤ä¸ªéƒ½æ³¨é‡Šæ—¶ï¼Œchangeä¸ç”Ÿæ•ˆï¼Œé€‰æ‹©æ—¥æœŸåä¼šç›´æ¥è‡ªåŠ¨å¡«å……é€‰å®šçš„æ—¥æœŸå¹¶å…³é—­å¼¹çª—ï¼Œä½†æ˜¯`type='month'`æ—¶é€‰æ‹©æœˆä»½åä¸ä¼šè‡ªåŠ¨å¡«å……å’Œå…³é—­ï¼Œéœ€è¦ç‚¹å‡»ç¡®å®šæŒ‰é’®  
**ç°å®éœ€æ±‚**
![image-20210127103959820](https://image.jianger.space/uPic/image-20210127103959820.png)

è¿™é‡Œæœ‰ä¸ªéœ€æ±‚æ˜¯ä¸¤æ¡æŠ˜çº¿æ•°æ®ï¼Œæ¨ªåæ ‡æ˜¯æœˆä»½ï¼Œä¸ºäº†é¿å…å‡ºç°ä¸¤ä¸ªç›¸åŒæœˆä»½å’Œæœˆä»½é¡ºåºé”™ä¹±çš„é—®é¢˜ï¼Œæˆ‘é‡‡å–äº†é™åˆ¶è·¨å¹´çš„æ–¹æ³•ã€‚  
ä½†changeäº‹ä»¶æ— æ•ˆå°±æ— æ³•é™åˆ¶æ—¥æœŸèŒƒå›´äº†ï¼Œè™½ç„¶å¯ä»¥åœ¨doneäº‹ä»¶ä¸­æ ¹æ®æ—¥æœŸæ˜¯å¦ç¬¦åˆæ¡ä»¶æ¸²æŸ“æ•°æ®ï¼Œä½†æ˜¯ä¸€ç‚¹å‡»ç¡®å®šæŒ‰é’®æ–°çš„æ—¥æœŸå°±è‡ªåŠ¨å¡«å……äº†ï¼Œdoneé‡Œå†é‡æ–°èµ‹å€¼ä¹Ÿä¸è¡Œã€‚åŒæ—¶ä¹Ÿè¯•è¿‡è‡ªå·±å†™ç‚¹å‡»äº‹ä»¶æ¥é™åˆ¶æœˆä»½ä¸è·¨å¹´ï¼Œä½†æ˜¯ä¸ç”Ÿæ•ˆï¼Œå³ä½¿ä½¿ç”¨äº†å¦‚`$(document).on("click",selector,funcation(){})`è¿™æ ·é’ˆå¯¹åŠ¨æ€ç”Ÿæˆå…ƒç´ ç»‘å®šäº‹ä»¶çš„æ–¹æ³•

**è§£å†³æ–¹æ¡ˆ**

1. ç¬¬ä¸€ç§æ–¹æ³•æ˜¯ä¸ä½¿ç”¨ä¸€ä¸ªæ—¥æœŸé€‰æ‹©æ¡†æ¥é€‰æ‹©æ—¥æœŸèŒƒå›´ï¼Œå°†èŒƒå›´é€‰æ‹©åˆ†ä¸ºä¸¤ä¸ªæ—¥æœŸé€‰æ‹©ï¼Œç„¶åæ ¹æ®å¼€å§‹æ—¥æœŸåŠ¨æ€æ›´æ”¹ç»“æŸæ—¥æœŸçš„é€‰æ‹©èŒƒå›´ï¼Œé€šè¿‡ä¿®æ”¹minã€maxå€¼æ¥å®ç°ã€‚
    
    ```javascript
    var startTime=laydate.render({
        elem: '#hqsjStart'
        ,trigger:'click'
        ,done:function (value,date) {
            endTime.config.min={
                year:date.year,
                month:date.month-1,//å…³é”®
                date:date.date
            };
        }
    });
    var endTime=laydate.render({
        elem: '#hqsjEnd'
        ,trigger:'click'
        ,done:function (value,date) {
            startTime.config.max={
                year:date.year,
                month:date.month-1,//å…³é”®
                date:date.date
            };
        }
    });
    ```
    
      
    
2. è¿™ç§æ–¹æ³•æˆ‘æ²¡æœ‰é‡‡ç”¨ï¼Œå› ä¸ºè¿™æ ·é€‰æ‹©æ¡†å¤ªå¤šäº†ï¼Œåœ¨è¿™ä¸ªéœ€æ±‚é‡Œå¾—å˜æˆå››ä¸ªé€‰æ‹©æ¡†ï¼Œå¹¶ä¸”åœ¨æ“ä½œä¸Šè¿ç»­æ€§æ²¡é‚£ä¹ˆå¼ºï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªèŒƒå›´é€‰æ‹©çš„è¯å¯ä»¥ä½¿ç”¨ã€‚  

3. ç¬¬äºŒç§æ–¹æ³•å°±æ˜¯ä¿®æ”¹laydate.jsçš„æºç äº†ï¼Œæ€è·¯å¦‚ä¸‹
    æ—¥æœŸåˆ‡æ¢åå°±åˆ¤æ–­æ˜¯å¦æ˜¯åŒä¸€å¹´ï¼Œä¸æ˜¯çš„è¯å°±ç¦ç”¨ç¡®å®šæŒ‰é’®ï¼Œå¹¶ç»™å‡ºæç¤ºä¿¡æ¯ï¼Œä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼Œå¤§æ¦‚åœ¨æºç 694è¡Œï¼ˆæºç æ ¼å¼åŒ–ä¹‹åï¼‰çš„ä½ç½®æ·»åŠ   

    ```javascript
    }, T.prototype.setBtnStatus = function(e, t, n) {
        var a, i = this,
            r = i.config,
            o = w(i.footer).find(g),
            d = r.range && "date" !== r.type && "time" !== r.type;
        d && (t = t || i.startDate, n = n || i.endDate, a = i.newDate(t).getTime() > i.newDate(n).getTime(), i.limit(null, t) ||
        i.limit(null, n) ? o.addClass(s) : o[a ? "addClass" : "removeClass"](s), e && a && i.hint("string" == typeof e ? l
            .replace(/æ—¥æœŸ/g, e) : l))
        //æ­¤å¤„ä¸ºæ·»åŠ çš„ä»£ç ,ä¸ºäº†é¿å…å½±å“å…¶ä»–é¡µé¢åŠ äº†è·¯å¾„åˆ¤æ–­,åªé’ˆå¯¹ç‰¹å®šé¡µé¢ç”Ÿæ•ˆ
        if (location.pathname == "/smsly/mgt/ticketAnalysis" && r.range && r.type == "month") {
            if (i.startDate.year != i.endDate.year) {
                o.addClass(s)
                i.hint("è¯·é€‰æ‹©åŒä¸€å¹´çš„æœˆä»½")
                l="è¯·é€‰æ‹©åŒä¸€å¹´çš„æœˆä»½"
            } else {
                o.removeClass(s)
            }
        }
    ```

æ•ˆæœå¦‚ä¸‹ï¼š
![image-20210127110856726](https://image.jianger.space/uPic/image-20210127110856726.png)

ç›´æ¥æ”¹æºç æ˜¯ä¸å¤ªæ¨èçš„,æˆ‘è¿™ä¸ªæ˜¯è¯•äº†å¤šç§æ–¹æ³•å®åœ¨æ²¡èƒ½è§£å†³æ‰åœ¨æºç ä¸Šæ”¹çš„,åç»­é‡åˆ°é—®é¢˜ç»§ç»­æ›´æ–°æœ¬ç¯‡